.row
  .col-xs-12
    .page-header
      %h3= "Visit: #{appointment.name}"
.row
  .col-lg-6
    %form.form-horizontal
      .form-group
        %label.col-xs-3.control-label{for: 'start_date'}= t(:appointment)[:start_date]
        .col-xs-3= text_field_tag 'start_date', format_date(appointment.start_date), class: 'form-control', data: {provide: "datepicker", 'date-format' => 'yyyy-mm-dd'}, appointment_id: appointment.id
        %label.col-xs-3.control-label{for: 'start_time'}= t(:appointment)[:start_time]
        .col-xs-3= text_field_tag 'start_time', format_time(appointment.start_date), class: 'atimepicker form-control', appointment_id: appointment.id
  .col-lg-6
    %form.form-horizontal
      .form-group
        %label.col-xs-3.control-label{for: 'completed_date'}= t(:appointment)[:completed_date]
        .col-xs-3= text_field_tag 'completed_date', format_date(appointment.completed_date), class: 'form-control', data: {provide: 'datepicker', 'date-format' => 'yyyy-mm-dd'}, appointment_id: appointment.id
        %label.col-xs-3.control-label{for: 'completed_time'}= t(:appointment)[:completed_time]
        .col-xs-3= text_field_tag 'completed_time', format_time(appointment.completed_date), class: 'atimepicker form-control', appointment_id: appointment.id
.row
  .col-xs-12
    .calendar.participant
      .row.header.text-center
        .col-xs-2= t(:appointment)[:procedure]
        .col-xs-1= t(:appointment)[:r_t]
        .col-xs-2= t(:appointment)[:status]
        .col-xs-2= t(:appointment)[:reason]
        .col-xs-2= t(:appointment)[:follow_up]
        .col-xs-2= t(:appointment)[:notes]
        .col-xs-1= t(:appointment)[:remove]
      - appointment.procedures_grouped_by_core.each do |core_id, procedures|
        .row.core{id: "core_#{core_id}"}
          .col-xs-12= "Core: #{procedures.first.sparc_core_name}"
        - procedures.each do |procedure|
          = render partial: 'procedure', locals: {procedure: procedure}
        .hidden{id: "end_of_core_#{core_id}"}
      .hidden{id: "end_of_appointment_#{appointment.id}"}

      %br
    .row
      .col-xs-4
        = select_tag "service_list", options_from_collection_for_select(Service.all_services, "id", "name"), class: 'form-control'
      .col-xs-2
        = text_field_tag "service_quantity", 1, class: "form-control"
      .col-xs-2
        .btn.btn-success.add_service{appointment_id: appointment.id}= t(:appointment)[:add_service]
      .col-xs-4